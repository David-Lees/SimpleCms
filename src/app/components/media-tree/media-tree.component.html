<ng-template #tmplNode let-node="node">
  <div class="node-item" [attr.data-id]="node.id" [attr.id]="'node-' + node.id">
    <div
      class="node-title"
      (click)="nodeClick(node)"
      [ngClass]="{ selected: selectedNodeId === node.id }"
    >
      {{ node.folders.length ? (node.isExpanded ? '-&nbsp;' : '+') : '&nbsp;&nbsp;&nbsp;' }}
      &nbsp;&nbsp;&nbsp; {{ node.name }}
    </div>

    <div
      *ngIf="node.isExpanded && node.folders.length"
      class="node-children"
      cdkDropList
      [cdkDropListData]="node.folders"
      [id]="node.id"
      [cdkDropListConnectedTo]="dropTargetIds"
      (cdkDropListDropped)="drop($event)"
      [cdkDropListSortingDisabled]="true"
    >
      <div
        *ngFor="let child of node.folders"
        cdkDrag
        [cdkDragData]="child.id"
        (cdkDragMoved)="dragMoved($event)"
      >
        <ng-container *ngTemplateOutlet="tmplNode; context: { node: child }"></ng-container>
      </div>
    </div>
  </div>
</ng-template>

<div class="ng-star-inserted">
  <div
    class="node-title"
    (click)="nodeClick(nodes)"
    [ngClass]="{ selected: selectedNodeId === nodes.id }"
  >
    Media
  </div>

  <div
    cdkDropList
    [cdkDropListData]="nodes"
    [id]="'main'"
    [cdkDropListConnectedTo]="dropTargetIds"
    (cdkDropListDropped)="drop($event)"
    [cdkDropListSortingDisabled]="true"
  >
    <div
      *ngFor="let node of nodes.folders"
      cdkDrag
      [cdkDragData]="node.id"
      (cdkDragMoved)="dragMoved($event)"
    >
      <ng-container *ngTemplateOutlet="tmplNode; context: { node: node }"></ng-container>
    </div>
  </div>
</div>
